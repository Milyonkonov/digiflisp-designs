OUTPORT:	EQU	$FB
INPORT:		EQU	$FC

		ORG	$00
STATE_INDEX:	FCB	0
STATE_VECTOR:	FCB	$05,$06,$0A,$09

START:		ORG 	$20
		LDX	#STATE_VECTOR
LOOP:		LDA	INPORT
		INCA				;INCA ANNARS ÄR EN DELAY AV 0 EGENTLIGEN EN DELAY AV FF
		JSR	DELAY
		LDA	STATE_INDEX
		LDA	A,X
		STA	OUTPORT
		JSR	NEXTSTATE
		STA	STATE_INDEX
		BRA	LOOP

DELAY:	DECA
	BNE DELAY
	RTS

NEXTSTATE:	INC	STATE_INDEX
		LDA	STATE_INDEX
		ANDA	#3
		RTS

		ORG	$FF
		FCB	START